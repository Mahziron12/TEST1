function [dudx_val,dudy_val,dudz_val,dvdx_val,dvdy_val,dvdz_val,dwdx_val,dwdy_val,dwdz_val] = func_deriv_vortexl(X_CP,Y_CP,Z_CP,X_1,Y_1,Z_1,X_2,Y_2,Z_2,GAMMA)


dudx_val = ...
(GAMMA*(2*(Y_1 - Y_2)*((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1)) + 2*(Z_1 - Z_2)*((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1)))*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1)))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)^2) - (GAMMA*((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))*((X_1 - X_2)/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - (X_1 - X_2)/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2) - ((2*X_CP - 2*X_1)*((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2)))/(2*((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(3/2)) + ((2*X_CP - 2*X_2)*((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2)))/(2*((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(3/2))))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2));
 
dudy_val = ...
- (GAMMA*((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))*((Y_1 - Y_2)/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - (Y_1 - Y_2)/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2) - ((2*Y_CP - 2*Y_1)*((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2)))/(2*((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(3/2)) + ((2*Y_CP - 2*Y_2)*((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2)))/(2*((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(3/2))))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)) - (GAMMA*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*(Z_1 - Z_2))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)) - (GAMMA*(2*(X_1 - X_2)*((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1)) - 2*(Z_1 - Z_2)*((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1)))*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1)))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)^2);

dudz_val = ...
(GAMMA*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*(Y_1 - Y_2))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)) - (GAMMA*((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))*((Z_1 - Z_2)/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - (Z_1 - Z_2)/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2) - ((2*Z_CP - 2*Z_1)*((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2)))/(2*((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(3/2)) + ((2*Z_CP - 2*Z_2)*((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2)))/(2*((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(3/2))))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)) - (GAMMA*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*(2*(X_1 - X_2)*((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1)) + 2*(Y_1 - Y_2)*((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1)))*((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1)))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)^2);


%%%%%%%%%

dvdx_val = ...
(GAMMA*((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))*((X_1 - X_2)/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - (X_1 - X_2)/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2) - ((2*X_CP - 2*X_1)*((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2)))/(2*((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(3/2)) + ((2*X_CP - 2*X_2)*((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2)))/(2*((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(3/2))))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)) + (GAMMA*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*(Z_1 - Z_2))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)) - (GAMMA*(2*(Y_1 - Y_2)*((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1)) + 2*(Z_1 - Z_2)*((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1)))*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1)))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)^2);

dvdy_val = ...
(GAMMA*((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))*((Y_1 - Y_2)/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - (Y_1 - Y_2)/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2) - ((2*Y_CP - 2*Y_1)*((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2)))/(2*((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(3/2)) + ((2*Y_CP - 2*Y_2)*((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2)))/(2*((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(3/2))))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)) + (GAMMA*(2*(X_1 - X_2)*((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1)) - 2*(Z_1 - Z_2)*((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1)))*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1)))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)^2);

dvdz_val = ...
(GAMMA*((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))*((Z_1 - Z_2)/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - (Z_1 - Z_2)/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2) - ((2*Z_CP - 2*Z_1)*((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2)))/(2*((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(3/2)) + ((2*Z_CP - 2*Z_2)*((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2)))/(2*((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(3/2))))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)) - (GAMMA*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*(X_1 - X_2))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)) + (GAMMA*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*(2*(X_1 - X_2)*((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1)) + 2*(Y_1 - Y_2)*((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1)))*((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1)))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)^2);

%%%%%%%%%

dwdx_val = ...
(GAMMA*(2*(Y_1 - Y_2)*((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1)) + 2*(Z_1 - Z_2)*((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1)))*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1)))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)^2) - (GAMMA*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*(Y_1 - Y_2))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)) - (GAMMA*((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))*((X_1 - X_2)/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - (X_1 - X_2)/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2) - ((2*X_CP - 2*X_1)*((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2)))/(2*((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(3/2)) + ((2*X_CP - 2*X_2)*((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2)))/(2*((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(3/2))))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2));

dwdy_val = ...
(GAMMA*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*(X_1 - X_2))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)) - (GAMMA*((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))*((Y_1 - Y_2)/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - (Y_1 - Y_2)/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2) - ((2*Y_CP - 2*Y_1)*((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2)))/(2*((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(3/2)) + ((2*Y_CP - 2*Y_2)*((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2)))/(2*((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(3/2))))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)) - (GAMMA*(2*(X_1 - X_2)*((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1)) - 2*(Z_1 - Z_2)*((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1)))*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1)))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)^2);

dwdz_val = ...
- (GAMMA*((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))*((Z_1 - Z_2)/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - (Z_1 - Z_2)/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2) - ((2*Z_CP - 2*Z_1)*((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2)))/(2*((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(3/2)) + ((2*Z_CP - 2*Z_2)*((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2)))/(2*((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(3/2))))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)) - (GAMMA*(((X_CP - X_1)*(X_1 - X_2) + (Y_CP - Y_1)*(Y_1 - Y_2) + (Z_CP - Z_1)*(Z_1 - Z_2))/((X_CP - X_1)^2 + (Y_CP - Y_1)^2 + (Z_CP - Z_1)^2)^(1/2) - ((X_CP - X_2)*(X_1 - X_2) + (Y_CP - Y_2)*(Y_1 - Y_2) + (Z_CP - Z_2)*(Z_1 - Z_2))/((X_CP - X_2)^2 + (Y_CP - Y_2)^2 + (Z_CP - Z_2)^2)^(1/2))*(2*(X_1 - X_2)*((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1)) + 2*(Y_1 - Y_2)*((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1)))*((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1)))/(4*pi*(((X_CP - X_1)*(Y_CP - Y_2) - (X_CP - X_2)*(Y_CP - Y_1))^2 + ((X_CP - X_1)*(Z_CP - Z_2) - (X_CP - X_2)*(Z_CP - Z_1))^2 + ((Y_CP - Y_1)*(Z_CP - Z_2) - (Y_CP - Y_2)*(Z_CP - Z_1))^2)^2);


end